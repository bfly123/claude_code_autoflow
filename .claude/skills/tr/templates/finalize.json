{
  "proto": "triflow.fileops.v1",
  "id": "TR-FINALIZE",
  "purpose": "finalize_step",
  "summary": "Finalize current step, then auto-loop to the next step if any",
  "done": ["State advanced (or task complete) and auto-loop triggered when needed"],
  "ops": [
    { "op": "triflow_state_finalize", "verification": "{{verification}}", "changedFiles": "{{changedFiles}}" },
    { "op": "run", "cmd": "python3 automation/autoloop.py --once", "cwd": ".", "timeoutMs": 600000 }
  ],
  "report": { "changedFiles": true, "diffSummary": true, "commandOutputs": "on_failure" },
  "_meta": {
    "placeholders": {
      "verification": "short description of how step was verified (from /review output)",
      "changedFiles": "optional array of changed file paths (from FileOpsRES.changedFiles)"
    }
  }
}
